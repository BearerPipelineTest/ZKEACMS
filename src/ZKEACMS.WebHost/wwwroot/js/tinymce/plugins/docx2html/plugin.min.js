tinymce.PluginManager.add("docx2html",function(t){function e(t){var e=document.getElementById("mammoth-convert");if(e)t();else{Easy.Block();var n=document.createElement("script");n.onload=function(){Easy.UnBlock(),t()},n.setAttribute("id","mammoth-convert"),n.src="https://cdn.bootcdn.net/ajax/libs/mammoth/1.4.21/mammoth.browser.min.js",document.head.appendChild(n)}}function n(t){var e=new FileReader;e.onload=function(e){var n=e.target.result;mammoth.convertToHtml({arrayBuffer:n}).then(t).catch(function(e){t({})}).done()};var n=document.getElementById("form-docx2html-field-file");e.readAsArrayBuffer(n.files[0])}t.ui.registry.addButton("docx2html",{icon:"gamma",tooltip:"Word",onAction:function(){e(function(){t.windowManager.open({title:"Word",body:{type:"panel",items:[{type:"htmlpanel",html:'<div class="tox-form__group"><input type="file" class="tox-textfield" id="form-docx2html-field-file"></div>'}]},buttons:[{type:"cancel",text:"cancel"},{type:"submit",text:"OK"}],onSubmit:function(e){Easy.Block(),n(function(e){Easy.UnBlock(),e.value&&t.undoManager.transact(function(){t.selection.setContent(e.value)})}),e.close()}})})}})});